<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Фонарик</title>
<style>
body {
  text-align:center;
  margin-top:100px;
  font-family:Arial;
}
button {
  padding:20px 40px;
  font-size:22px;
}
</style>
</head>
<body>

<button id="btn">Включить фонарик</button>

<script>
let track;
let stream;
let isOn = false;

const btn = document.getElementById("btn");

btn.addEventListener("click", async () => {
  try {
    if (!stream) {
      stream = await navigator.mediaDevices.getUserMedia({
        video: {
          facingMode: "environment"
        }
      });
      track = stream.getVideoTracks()[0];
    }

    // Пробуем включить torch без проверки capabilities
    isOn = !isOn;

    await track.applyConstraints({
      advanced: [{ torch: isOn }]
    });

    btn.textContent = isOn ? "Выключить фонарик" : "Включить фонарик";

  } catch (err) {
    alert("Ошибка: " + err.message);
  }
});
</script>

</body>
</html>
