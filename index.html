<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Фонарик</title>
</head>
<body>

<button onclick="toggleFlash()">Включить фонарик</button>

<script>
let track;
let isOn = false;

async function toggleFlash() {
  try {
    if (!track) {
      const stream = await navigator.mediaDevices.getUserMedia({
        video: { facingMode: "environment" }
      });
      track = stream.getVideoTracks()[0];
    }

    const capabilities = track.getCapabilities();

    if (!capabilities.torch) {
      alert("Фонарик не поддерживается на этом устройстве");
      return;
    }

    isOn = !isOn;

    await track.applyConstraints({
      advanced: [{ torch: isOn }]
    });

    document.querySelector("button").textContent =
      isOn ? "Выключить фонарик" : "Включить фонарик";

  } catch (err) {
    alert("Ошибка: " + err);
  }
}
</script>

</body>
</html>
