<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>QR Scanner</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://unpkg.com/html5-qrcode"></script>

<style>
body {
  font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
  background: #f2f2f7;
  margin: 0;
  padding: 15px;
}
.app { max-width: 420px; margin: auto; }
h2 { text-align: center; margin-bottom: 6px; }

.scan-btn {
  width: 100%;
  margin: 6px 0 14px;
  background: #34c759;
  color: white;
  font-size: 16px;
  padding: 14px;
  border-radius: 14px;
  border: none;
}
.scan-btn.off { background: #aaa; }

#reader {
  position: relative;
  border-radius: 16px;
  overflow: hidden;
  background: black;
}

.scan-frame {
  position: absolute;
  top: 50%;
  left: 50%;
  width: 220px;
  height: 220px;
  transform: translate(-50%, -50%);
  border-radius: 18px;
  border: 3px solid rgba(255,255,255,0.9);
  box-shadow: 0 0 0 2000px rgba(0,0,0,0.35);
  pointer-events: none;
}

.card {
  background: white;
  border-radius: 16px;
  padding: 14px;
  margin-top: 15px;
  box-shadow: 0 4px 10px rgba(0,0,0,0.08);
}

.row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 8px 0;
  border-bottom: 1px solid #eee;
}
.row:last-child { border-bottom: none; }

.label { color: #888; font-size: 13px; }
.value { font-size: 16px; font-weight: 500; }

.call-btn {
  background: #34c759;
  width: 36px;
  height: 36px;
  border-radius: 50%;
  border: none;
  color: white;
  font-size: 18px;
}
.call-btn:disabled { background: #ccc; }

.buttons { display: flex; gap: 10px; margin-top: 15px; }
button {
  flex: 1;
  padding: 14px;
  border-radius: 14px;
  border: none;
  font-size: 15px;
}

.google { background: #4285f4; color: white; }
.apple { background: black; color: white; }
.gray { background: #ddd; }

.history-item {
  padding: 8px;
  border-bottom: 1px solid #eee;
  font-size: 14px;
}
.history-item.active {
  background: #e5f0ff;
  border-radius: 10px;
}
.history-item b { display: block; }

input {
  width: 100%;
  padding: 10px;
  border-radius: 10px;
  border: 1px solid #ccc;
  font-size: 15px;
}
</style>
</head>

<body>
<div class="app">

<h2>üì∑ QR-Scanner</h2>
<button id="scanToggle" class="scan-btn">‚ñ∂Ô∏è Scannen</button>
<div id="reader"></div>

<!-- –î–ê–ù–ù–´–ï -->
<div class="card">
  <div class="row"><div><div class="label">Adresse</div><div id="address">‚Äî</div></div></div>
  <div class="row">
    <div><div class="label">Telefon</div><div id="phone">‚Äî</div></div>
    <button class="call-btn" id="callBtn" disabled>üìû</button>
  </div>
  <div class="row"><div><div class="label">Betrag (‚Ç¨)</div><div id="amount">‚Äî</div></div></div>
</div>

<div class="buttons">
  <button class="google" id="googleBtn" disabled>Google Maps</button>
  <button class="apple" id="appleBtn" disabled>Apple Maps</button>
</div>

<!-- –ò–°–¢–û–†–ò–Ø -->
<div class="card">
  <div class="label">Heutige Eintr√§ge</div>
  <div id="history"></div>
</div>

<!-- –û–¢–ß–Å–¢ -->
<div class="card">
  <div class="label">Schichtbericht</div>

  <div class="row"><span>Anzahl Adressen</span><b id="count">0</b></div>
  <div class="row"><span>Summe Betrag (‚Ç¨)</span><b id="sum">0.00</b></div>

  <div class="row"><span>Lohn (‚Ç¨)</span><input id="lohn" type="number" step="0.01"></div>
  <div class="row"><span>Benzin (‚Ç¨)</span><input id="benzin" type="number" step="0.01"></div>
  <div class="row"><span>Sonstige (‚Ç¨)</span><input id="sonstige" type="number" step="0.01"></div>

  <div class="row">
    <span><b>Ergebnis (‚Ç¨)</b></span>
    <b id="result">0.00</b>
  </div>
</div>

</div>

<script>
const today = new Date().toISOString().slice(0,10);
let history = JSON.parse(localStorage.getItem("qrHistory")||"[]")
  .filter(i=>i.date===today);

const save = () => localStorage.setItem("qrHistory",JSON.stringify(history));

function updateReport(){
  const sum = history.reduce((a,b)=>a+(+b.amount||0),0);
  count.textContent = history.length;
  sumEl.textContent = sum.toFixed(2);

  const l=+lohn.value||0, b=+benzin.value||0, s=+sonstige.value||0;
  result.textContent = (sum-l-b-s).toFixed(2);

  localStorage.setItem("shift-"+today,JSON.stringify({l,b,s}));
}

const stored = JSON.parse(localStorage.getItem("shift-"+today)||"{}");
lohn.value=stored.l||""; benzin.value=stored.b||""; sonstige.value=stored.s||"";

[lohn,benzin,sonstige].forEach(i=>i.oninput=updateReport);

const count=document.getElementById("count");
const sumEl=document.getElementById("sum");
const result=document.getElementById("result");

updateReport();
</script>
</body>
</html>
