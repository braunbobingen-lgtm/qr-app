<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Фонарик</title>
<style>
body {
  text-align: center;
  margin-top: 100px;
  font-family: Arial;
}
button {
  padding: 20px 40px;
  font-size: 20px;
}
</style>
</head>
<body>

<button id="btn">Включить фонарик</button>

<script>
let stream = null;
let track = null;
let isOn = false;

const btn = document.getElementById("btn");

btn.addEventListener("click", async () => {
  try {
    if (!stream) {
      stream = await navigator.mediaDevices.getUserMedia({
        video: { facingMode: { exact: "environment" } }
      });
      track = stream.getVideoTracks()[0];
    }

    const capabilities = track.getCapabilities();

    if (!capabilities.torch) {
      alert("Фонарик не поддерживается на этом устройстве");
      return;
    }

    isOn = !isOn;

    await track.applyConstraints({
      advanced: [{ torch: isOn }]
    });

    btn.textContent = isOn
      ? "Выключить фонарик"
      : "Включить фонарик";

  } catch (e) {
    alert("Ошибка: " + e.message);
  }
});
</script>

</body>
</html>
